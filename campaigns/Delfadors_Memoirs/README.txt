Done. Writeup and diffs to come.
